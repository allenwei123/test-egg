webpackJsonp([13],{Nv6f:function(t,e){},Pudk:function(t,e){},VJwz:function(t,e){},uRvg:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("mvHQ"),n=i.n(o),l=i("CzdK"),r={data:function(){return{formVisible:this.visible,communityList:[],file:null,form:{title:"",client:"1000",href:"",materialUrl:null},fileList2:[]}},watch:{visible:function(t){this.formVisible=t},formVisible:function(t){this.$emit("update:visible",t)}},methods:{showInfo:function(t){this.$message({message:t,type:"warning"})},closeForm:function(){this.formVisible=!1},preview:function(){},up:function(){},onExceed:function(){this.$message("只能上传一张图片")},save:function(){var t=this;if(this.form.title.length)if(this.form.href.length){var e=this.$refs.upload.uploadFiles;e.length?Object(l.b)(e[0].raw,function(e){t.form.materialUrl=e,t.submitForm()}):this.submitForm()}else this.showInfo("公告内容不能为空");else this.showInfo("公告标题不能为空")},submitForm:function(){var t=this;this.loading=!0;var e={};e.client=this.form.client,e.title=this.form.title,e.href=this.form.href,this.form.materialUrl&&(e.materialUrl=this.form.materialUrl);var i="sys/slide/add";this.isModify&&(i="sys/slide/edit",e.id=this.detail.id),this.$xttp.post(i,e).then(function(e){t.loading=!1,console.log(e),0===e.errorCode&&(t.formVisible=!1,t.$emit("saveSuccess"))}).catch(function(){t.loading=!1})}},props:["visible","detail","isModify"],created:function(){var t=this;this.isModify&&(this.form.title=this.detail.title,this.form.client=this.detail.client.toString(),this.form.materialUrl=this.detail.materialUrl,this.form.href=this.detail.href,this.detail.materialUrl&&Object(l.a)(this.detail.materialUrl,function(e){t.fileList2.push({url:e})}))}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"新增轮播图",visible:t.formVisible},on:{"update:visible":function(e){t.formVisible=e}}},[i("el-form",{attrs:{model:t.form,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"标题","label-width":"120px",required:""}},[i("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title","string"==typeof e?e.trim():e)},expression:"form.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"客户类型",required:""}},[i("el-select",{attrs:{placeholder:"请选择客户端类型"},model:{value:t.form.client,callback:function(e){t.$set(t.form,"client",e)},expression:"form.client"}},[i("el-option",{attrs:{label:"住户端",value:"1000"}}),t._v(" "),i("el-option",{attrs:{label:"物业端",value:"1001"}}),t._v(" "),i("el-option",{attrs:{label:"WEB后台",value:"1002"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"轮播图",required:""}},[[i("el-upload",{ref:"upload",attrs:{action:"","auto-upload":!1,limit:1,accept:"image/*","on-exceed":t.onExceed,"file-list":t.fileList2,"list-type":"picture-card"}},[i("i",{staticClass:"el-icon-plus"})])]],2),t._v(" "),i("el-form-item",{attrs:{label:"跳转链接","label-width":"120px",required:""}},[i("el-input",{model:{value:t.form.href,callback:function(e){t.$set(t.form,"href","string"==typeof e?e.trim():e)},expression:"form.href"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.closeForm}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)],1)},staticRenderFns:[]};var s={data:function(){return{previewVisible:this.visible,communityName:this.$store.getters.communityName,uri:""}},watch:{visible:function(t){this.previewVisible=t},previewVisible:function(t){this.$emit("update:visible",t)}},props:["visible","noticeInfo"],computed:{time:function(){var t=this.noticeInfo.updateAt;return t||(t=(new Date).getTime()),t}},created:function(){var t=this;this.noticeInfo.materialUrl&&Object(l.a)(this.noticeInfo.materialUrl,function(e){t.uri=e})}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"公告预览",visible:t.previewVisible},on:{"update:visible":function(e){t.previewVisible=e}}},[t.noticeInfo?i("div",{staticClass:"c-preview-container"},[i("h1",[t._v("标题："+t._s(t.noticeInfo.title))]),t._v(" "),t.uri?i("div",{staticClass:"c-image"},[t._v("图片："),i("img",{attrs:{src:t.uri}})]):t._e(),t._v(" "),i("p",[i("span",[t._v(t._s(t._f("time")(t.time,"yyyy-MM-dd HH:mm")))]),t._v(" "),i("br")]),i("p",{staticStyle:{"margin-left":"20px",width:"70%",overflow:"hidden"}},[t._v("链接："),i("a",[t._v(t._s(t.noticeInfo.href))])]),t._v(" "),i("div",[i("pre",[t._v("客户端："+t._s(t.noticeInfo.client))])])]):t._e()])},staticRenderFns:[]};var u={name:"notice",components:{NoticeForm:i("VU/8")(r,a,!1,function(t){i("Nv6f")},"data-v-7b4988cb",null).exports,NoticePreview:i("VU/8")(s,c,!1,function(t){i("VJwz")},"data-v-cc866e28",null).exports},data:function(){return{loading:!1,isShow:!1,tableData:[],pageSize:10,total:0,currentPage:1,formVisible:!1,formIsModify:!1,formDetail:{},previewVisible:!1,previewNoticeInfo:null,input:"",q_input:null}},methods:{query:function(){this.q_input=this.input,1!==this.currentPage?this.currentPage=1:this.getTableList()},clientFilter:function(t){return{1000:"住户端",1001:"物业端",1002:"WEB后台"}[t]},getPublishedName:function(t){return{1:"已发布",0:"未发布"}[t]},dataStatusFilter:function(t){return{0:"无效",1:"有效"}[t]},getNoticeTypeName:function(t){return{1:"公告",2:"新闻",3:"活动",4:"提醒",99:"其他"}[t]},getPublishStatusName:function(t){return{"-1":"已撤销",0:"未发布",1:"已发布"}[t]},publish:function(t){var e=this;this.loading=!0;var i="sys/slide/"+t.id+"/publish";this.$xttp.get(i).then(function(i){e.loading=!1,0===i.errorCode&&(t.published=1)}).catch(function(){e.loading=!1})},del:function(t){var e=this;this.$confirm("确认删除轮播图？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.loading=!0,e.$xttp.get("sys/slide/"+t.id+"/delete").then(function(t){e.loading=!1,0===t.errorCode&&e.getTableList()}).catch(function(){e.loading=!1})}).catch(function(){})},modify:function(t){this.formIsModify=!0,this.formDetail=t,this.formVisible=!0},addNotice:function(){this.formIsModify=!1,this.formVisible=!0},preview:function(t){this.previewNoticeInfo=t,this.previewVisible=!0},deepCopy:function(t){return JSON.parse(n()(t))},push:function(t){var e=this;this.$confirm("确认推送此公告吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.loading=!0,e.$xttp.get("property/notice/"+t.id+"/push").then(function(t){e.loading=!1,0===t.errorCode&&e.getTableList()}).catch(function(){e.loading=!1})})},revoke:function(t){var e=this;this.loading=!0;var i=t.id;this.$xttp.get("sys/slide/"+i+"/retract").then(function(t){e.loading=!1,0===t.errorCode&&e.getTableList()}).catch(function(){e.loading=!1})},getTableList:function(){var t=this;this.loading=!0;var e="/sys/slide/page?page="+this.currentPage+"&size="+this.pageSize,i={};this.q_input&&(i.title=this.q_input),this.$xttp.post(e,i).then(function(e){t.loading=!1,0===e.errorCode&&(t.tableData=e.data.records,t.total=e.data.total)}).catch(function(){t.loading=!1})}},created:function(){this.getTableList()}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-container",[i("el-main",[i("div",{staticClass:"c-notice-container"},[i("div",{staticClass:"c-searchbar"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[i("el-form-item",{attrs:{label:""}},[i("el-input",{attrs:{placeholder:"标题"},model:{value:t.input,callback:function(e){t.input="string"==typeof e?e.trim():e},expression:"input"}})],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.query}},[t._v("查询")])],1),t._v(" "),i("el-form-item",{staticStyle:{float:"right"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.addNotice}},[t._v("新增轮播图")])],1)],1)],1),t._v(" "),i("div",{staticClass:"c-list"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""}},[i("el-table-column",{attrs:{label:"序号",width:"60","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s((t.currentPage-1)*t.pageSize+e.$index+1))]}}])}),t._v(" "),t.isShow?i("el-table-column",{attrs:{label:"ID",width:"80","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.id))]}}])}):t._e(),t._v(" "),t.isShow?i("el-table-column",{attrs:{label:"社区ID",width:"80","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.communityId))]}}])}):t._e(),t._v(" "),i("el-table-column",{attrs:{label:"标题","min-width":"250",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.title))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"类型","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.clientFilter(e.row.client)))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"素材链接","min-width":"300",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text"}},[t._v(t._s(e.row.materialUrl))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"标签","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.tags))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"跳转链接","min-width":"300",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text"}},[t._v(t._s(e.row.href))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"开始时间","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("time")(e.row.beginAt,"yyyy-MM-dd HH:mm")))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"结束时间","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("time")(e.row.deadline,"yyyy-MM-dd HH:mm")))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"发布状态","min-width":"160",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.getPublishedName(e.row.published)))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"发布时间","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("time")(e.row.publishAt,"yyyy-MM-dd HH:mm")))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"创建时间","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("time")(e.row.createAt,"yyyy-MM-dd HH:mm")))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"修改时间","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("time")(e.row.updateAt,"yyyy-MM-dd HH:mm")))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"数据状态","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.dataStatusFilter(e.row.dataStatus)))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"300",align:"center",fixed:t.tableData.length?"right":"/"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.preview(e.row)}}},[t._v("预览")]),t._v(" "),1===e.row.published?[0===e.row.published?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.push(e.row)}}},[t._v("推送")]):t._e(),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.revoke(e.row)}}},[t._v("撤销")])]:t._e(),t._v(" "),1!==e.row.published?[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.publish(e.row)}}},[t._v("发布")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){t.del(e.row)}}},[t._v("删除")])]:t._e()]}}])})],1)],1),t._v(" "),i("div",{staticClass:"c-pagination"},[i("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",total:t.total,"page-size":t.pageSize,"current-page":t.currentPage},on:{"current-change":t.getTableList,"update:currentPage":function(e){t.currentPage=e}}})],1)]),t._v(" "),t.formVisible?i("NoticeForm",{attrs:{detail:t.formDetail,isModify:t.formIsModify,visible:t.formVisible},on:{"update:visible":function(e){t.formVisible=e},saveSuccess:t.getTableList}}):t._e(),t._v(" "),t.previewVisible?i("NoticePreview",{attrs:{visible:t.previewVisible,noticeInfo:t.previewNoticeInfo},on:{"update:visible":function(e){t.previewVisible=e}}}):t._e()],1)],1)},staticRenderFns:[]};var d=i("VU/8")(u,f,!1,function(t){i("Pudk")},"data-v-220faab7",null);e.default=d.exports}});
//# sourceMappingURL=13.7887ba51e1b5b53442b4.js.map