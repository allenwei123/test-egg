webpackJsonp([10],{VyDJ:function(t,e){},"a++4":function(t,e){},jZVw:function(t,e){},"r/j9":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("mtWM");var i=a("CtSm"),n={name:"floorFileForm",data:function(){return{formLabelWidth:"120px",titleFont:"添加房间档案",isShow:!1,form:{name:"",communityIdShow:Object(i.a)(this.$store.getters.communityList,this.$store.getters.communityId),communityId:this.$store.getters.communityId,buildingId:"",floorCode:"",area:""},rules:{name:[{required:!0,message:"请输入房间编号",trigger:"blur"}],buildingId:[{required:!0,message:"请输入楼栋名称",trigger:"blur"}],floorCode:[{required:!0,message:"请输入楼层",trigger:"blur"}],area:[{required:!0,message:"请输入面积",trigger:"blur"}]},floorOptions:[],current:1}},props:["msg","add"],created:function(){this.selectCommunity(),this.add&&(this.form=this.add,console.log(this.add),this.titleFont="编辑房间档案",this.form.communityIdShow=this.$store.getters.communityName,this.form.area=(this.add.area/100).toFixed(2))},mounted:function(){},methods:{handleClose:function(){this.$emit("upup",this.current)},save:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.postData()})},selectCommunity:function(){var t=this,e={communityId:this.form.communityId};this.$xttp.get("/community/building/list",{params:e}).then(function(e){e.errorCode||(t.floorOptions=e.data)})},postData:function(){var t=this,e=this.add?"编辑":"添加",a=this.add?"/community/room/edit":"/community/room/add",i=this.form.name,n=this.form.communityId,o=this.form.buildingId,l=this.form.floorCode,s=this.form.area,r=this.form.communityIdShow,c={};this.add&&(c.id=this.add.id),c.name=i,c.communityId=n,c.communityIdShow=r,c.buildingId=o,c.floorCode=l,c.area=100*s,this.$xttp.post(a,c).then(function(a){0===a.errorCode?(t.$message({message:e+"房间成功",type:"success"}),t.current=3,t.handleClose(),t.$emit("reload")):t.$message({message:a.data.errorMsg,type:"error"})}).catch(function(t){console.log(t)})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.titleFont,visible:t.msg,"before-close":t.handleClose},on:{"update:visible":function(e){t.msg=e}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{model:t.form,rules:t.rules}},[a("el-form-item",{staticClass:"c-must",attrs:{label:"房间编号","label-width":t.formLabelWidth,prop:"name"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{staticClass:"c-must",attrs:{label:"所属楼栋",prop:"buildingId","label-width":t.formLabelWidth}},[a("el-select",{attrs:{clearable:""},model:{value:t.form.buildingId,callback:function(e){t.$set(t.form,"buildingId",e)},expression:"form.buildingId"}},t._l(t.floorOptions,function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],1),t._v(" "),a("el-form-item",{staticClass:"c-must",attrs:{label:"所在楼层",prop:"floorCode","label-width":t.formLabelWidth}},[a("el-input-number",{attrs:{min:-5,max:100,label:"选择所在楼层"},model:{value:t.form.floorCode,callback:function(e){t.$set(t.form,"floorCode",e)},expression:"form.floorCode"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"住房面积",prop:"area","label-width":t.formLabelWidth}},[a("el-input",{attrs:{type:"number"},model:{value:t.form.area,callback:function(e){t.$set(t.form,"area",e)},expression:"form.area"}})],1),t._v(" "),a("el-form-item",{attrs:{"label-width":t.formLabelWidth}},[a("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.save("ruleForm")}}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[]};var l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"房间档案详情",visible:t.msg,"before-close":t.handleClose},on:{"update:visible":function(e){t.msg=e}}},[a("ul",[a("li",{staticClass:"c-list"},[a("span",{staticClass:"c-label"},[t._v("房间名称:")]),t._v(" "),a("span",{staticClass:"c-content"},[t._v(" "+t._s(t.data.name)+" ")])]),t._v(" "),a("li",{staticClass:"c-list"},[a("span",{staticClass:"c-label"},[t._v("房间编号:")]),t._v(" "),a("span",{staticClass:"c-content"},[t._v(" "+t._s(t.data.code)+" ")])]),t._v(" "),a("li",{staticClass:"c-list"},[a("span",{staticClass:"c-label"},[t._v("房间楼层:")]),t._v(" "),a("span",{staticClass:"c-content"},[t._v(" "+t._s(t.data.floorCode)+" ")])]),t._v(" "),a("li",{staticClass:"c-list"},[a("span",{staticClass:"c-label"},[t._v("楼层号:")]),t._v(" "),a("span",{staticClass:"c-content"},[t._v(" "+t._s(t.data.floorCode)+" ")])]),t._v(" "),a("li",{staticClass:"c-list"},[a("span",{staticClass:"c-label"},[t._v("面积:")]),t._v(" "),a("span",{staticClass:"c-content"},[t._v(" "+t._s(t.data.area)+" ")])]),t._v(" "),a("li",{staticClass:"c-list"},[a("span",{staticClass:"c-label"},[t._v("创建时间:")]),t._v(" "),a("span",{staticClass:"c-content"},[t._v(" "+t._s(t._f("time")(t.data.createAt))+" ")])])])])},staticRenderFns:[]};var s={name:"floorFileList",data:function(){return{isSou:!1,tableData:[],navDetailData:[{id:0,name:"首页"},{id:1,name:"基础管理"},{id:2,name:"房间档案"}],formInline:{name:"",floorSer:"",select:""},currentPage:1,loading:!1,isShow:!1,total:0,pageSize:10,notice:null,see:!1,seeData:null,floorOptions:[],visible2:!1,delData:null}},components:{AddPage:a("VU/8")(n,o,!1,function(t){a("VyDJ")},"data-v-f594d576",null).exports,SeePage:a("VU/8")({name:"ChargeSee",data:function(){return{arr:[1,2,4,5]}},props:["msg","data"],created:function(){},methods:{handleClose:function(){this.$emit("upsee",!1)}}},l,!1,function(t){a("a++4")},"data-v-d4848424",null).exports},methods:{onSubmit:function(){this.notice=null,this.isShow=!this.isShow},handleCurrentChange:function(t){this.currentPage!==t&&this.sendAjax(t,this.formInline.floorSer,this.formInline.name)},handleClick:function(t){this.see=!0,this.seeData=t},editHandle:function(t){this.isShow=!0,this.notice=t},selectCommunity:function(t){var e=this,a={communityId:this.$store.getters.communityId};this.$xttp.get("/community/building/list",{params:a}).then(function(a){a.errorCode||(e.floorOptions=a.data,e.formInline.floorSer=e.floorOptions[0].id),t&&e.sendAjax(1,e.formInline.floorSer)})},change:function(t){1==t?this.isShow=!1:2!=t&&3!=t||(this.isShow=!1),this.sendAjax(1,this.formInline.floorSer)},delHandle:function(t){this.visible2=!0,this.delData=t},confirmDel:function(){var t=this;this.delData.id&&this.$xttp.get("/community/room/"+this.delData.id+"/delete").then(function(e){e.errorCode?(t.visible2=!1,t.delData=null):(t.visible2=!1,t.delData=null,t.$message({message:e.data,type:"success"}),t.find())}).catch(function(t){console.log(t)})},changeFloor:function(){this.find()},seeChange:function(t){this.see=!1},find:function(){this.sendAjax(1,this.formInline.floorSer,this.formInline.name)},sendAjax:function(t,e,a){var i=this,n=t||this.$route.query.page||1,o={page:n};e?o.buildingId=this.formInline.floorSer:delete o.buildingId,a?o.name=this.formInline.name:delete o.name,this.loading=!0,this.$xttp.get("/community/room/page",{params:o}).then(function(t){t.errorCode||(i.tableData=t.data.records,i.currentPage=t.data.currentPage,i.total=t.data.total,i.tableData.forEach(function(t){t.createAt&&(t.time1=new Date(t.createAt).toISOString().split(".")[0].replace("T"," "))}),i.$router.push({path:i.$route.path,query:{page:n}})),i.loading=!1}).catch(function(t){i.loading=!1})}},created:function(){this.selectCommunity(1)},mounted:function(){}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-main",[a("div",[a("ul",{staticClass:"c-navDetail clear"},t._l(t.navDetailData,function(e,i){return a("li",{key:i},[t._v(t._s(e.name)+" "),i!==t.navDetailData.length-1?a("span",[t._v(" > ")]):t._e()])})),t._v(" "),a("div",{staticClass:"c-search"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formInline}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"选择楼栋搜索"},on:{change:t.changeFloor},model:{value:t.formInline.floorSer,callback:function(e){t.$set(t.formInline,"floorSer",e)},expression:"formInline.floorSer"}},t._l(t.floorOptions,function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],1),t._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"房号"},model:{value:t.formInline.name,callback:function(e){t.$set(t.formInline,"name","string"==typeof e?e.trim():e)},expression:"formInline.name"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.find}},[a("i",{staticClass:"iconfont icon-sousuo"},[t._v(" ")]),t._v("查询")])],1)],1),t._v(" "),a("el-button",{staticClass:"c-addBtn",attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("新增房间")])],1)]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"c-table",staticStyle:{width:"100%"},attrs:{data:t.tableData,"element-loading-text":"加载中...",border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"序号",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s((t.currentPage-1)*t.pageSize+e.$index+1))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"房号","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.name))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"所在楼层","min-width":"100",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.floorCode))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"房间面积(P)","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s((e.row.area/100).toFixed(2)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"left",fixed:"right",label:"操作",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(a){t.editHandle(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){t.delHandle(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("div",{staticClass:"c-block"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("transition",{attrs:{name:"fade1"}},[t.isShow?a("AddPage",{attrs:{msg:t.isShow,add:t.notice},on:{upup:t.change,reload:t.find,"update:add":function(e){t.notice=e}}}):t._e()],1),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.see?a("SeePage",{attrs:{msg:t.see,data:t.seeData},on:{upsee:t.seeChange}}):t._e()],1),t._v(" "),a("el-dialog",{attrs:{title:"温馨提示",visible:t.visible2},on:{"update:visible":function(e){t.visible2=e}}},[a("p",[t._v("请问您是否确定删除这条数据吗？")]),t._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.visible2=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.confirmDel}},[t._v("确定")])],1)])],1)},staticRenderFns:[]};var c=a("VU/8")(s,r,!1,function(t){a("jZVw")},"data-v-514d1bc9",null);e.default=c.exports}});
//# sourceMappingURL=10.c66369f20718ad22dee5.js.map