webpackJsonp([9],{"4QGD":function(e,t){},"9duW":function(e,t){},ETRs:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"ChargeSee",data:function(){return{formLabelWidth:"120px",isShow:!1,form:{feeItemId:"",itemName:""},status:"",loading:!1,arr:[1,2,4,5],tableData:[],page:1,pageSize:100,currentPage:1}},props:["msg","detail"],created:function(){this.getTableList()},methods:{textChange:function(){console.log(888)},handleClose:function(){this.$emit("upsee",!1)},showInfo:function(e,t){this.$message({message:e,type:t})},getTableList:function(){var e=this,t=this.detail.id,i=this.$store.getters.communityId;this.form.itemName=this.detail.itemName,this.form.feeItemId=t,this.loading=!0;var a="/fees/rule/"+i+"/page?page="+this.currentPage+"&size="+this.pageSize+"&feeItemId="+t;this.$xttp.get(a).then(function(t){e.loading=!1,t.success&&(e.tableData=t.data.records,e.loading=!1)}).catch(function(){e.loading=!1})},editPrice:function(e){var t=this,i="/fees/rule/"+e.id+"/edit";this.$prompt("请输入价格","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[+|-]?\d*\.?\d*$/,inputErrorMessage:"请输入数字类型"}).then(function(e){var a=1e4*e.value;console.log(a),t.$xttp.get(i,{params:{unitPrice:a}}).then(function(e){e.success&&t.getTableList()})}).catch(function(){})},editProject:function(){var e=this,t=this.form.itemName,i=this.form.feeItemId,a={};if(""!=t&&0!=t.length){a.id=i,a.itemName=t;var s="fees/item/edit/"+i;this.$xttp.post(s,a).then(function(t){e.loading=!1,t.success&&(e.form.itemName=t.data.itemName,e.$emit("reload"),e.showInfo("修改项目名称成功","success"))}).catch(function(){e.loading=fasle})}else this.showInfo("项目名称不能为空","warning")}}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"查看详情",visible:e.msg,"before-close":e.handleClose},on:{"update:visible":function(t){e.msg=t}}},[i("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{model:e.form}},[e.isShow?i("el-form-item",{staticClass:"c-must",attrs:{label:"项目ID：","label-width":e.formLabelWidth,prop:"feeItemId"}},[i("el-input",{model:{value:e.form.feeItemId,callback:function(t){e.$set(e.form,"feeItemId",t)},expression:"form.feeItemId"}})],1):e._e(),e._v(" "),i("el-form-item",{staticClass:"c-must",attrs:{label:"项目名称：","label-width":e.formLabelWidth,prop:"itemName"}},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:12}},[i("el-input",{model:{value:e.form.itemName,callback:function(t){e.$set(e.form,"itemName","string"==typeof t?t.trim():t)},expression:"form.itemName"}})],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-button",{attrs:{type:"primary",plain:""},on:{click:e.editProject}},[e._v("修改项目名称")])],1)],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"c-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""}},[e.isShow?i("el-table-column",{attrs:{label:"ID",width:"120",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.id))]}}])}):e._e(),e._v(" "),i("el-table-column",{attrs:{label:"楼栋",width:"120",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.buildingName))]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"价格(元)","min-width":"80",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.unitPrice/1e4))]}}])}),e._v(" "),i("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{keyup:e.textChange,click:function(i){e.editPrice(t.row)}}},[e._v("修改价格")])]}}])})],1)],1)],1)},staticRenderFns:[]};var o=i("VU/8")(a,s,!1,function(e){i("9duW")},"data-v-5c39a4fa",null).exports,r={name:"ChargeAdd",data:function(){return{formLabelWidth:"120px",titleFont:"新增项目",isShow:!0,disabled:!0,form:{unitPrice:"0",itemName:"",type:"",floorSer:""},rules:{itemName:[{required:!0,message:"请输入项目名称",trigger:"blur"}],type:[{required:!0,message:"请选择计费规则",trigger:"blur"}],unitPrice:[{required:!0,message:"请输入单价",trigger:"blur"}]},floorOptions:[],chargeTypesOptions:[],current:1}},props:["msg","add","projectData"],created:function(){this.add?(this.form=this.add,this.titleFont="编辑项目",this.form.unitPrice=this.projectData.unitPrice/1e4,console.log(this.projectData.unitPrice),console.log(this.projectData.type),this.form.type=this.projectData.type,this.form.floorSer=this.projectData.floorSer,this.form.itemName=this.projectData.itemName):(this.selectCommunity(),this.chargeType())},mounted:function(){},methods:{handleClose:function(){this.$emit("upup",this.current)},save:function(){var e=this,t=this.add?"编辑":"添加",i=this.add?"/community/edit":"/fees/item-rule/addAll",a={},s=this.$store.getters.communityId,o=localStorage.getItem("propertyId"),r=this.form.itemName,n=this.form.type;if(3!=n){var l=this.form.unitPrice.toFixed(2);a.unitPrice=parseInt(1e4*l)}else{a.unitPrice=0}var c=this.form.floorSer;a.communityId=s,a.propertyId=o,a.itemName=r,a.type=n,a.floorSer=c,this.$xttp.post(i,a).then(function(i){i.success?(e.$message({message:t+"项目成功",type:"success"}),e.current=2,e.handleClose(),e.$emit("reload")):e.$message({message:i.data.errorMsg,type:"error"})}).catch(function(e){console.log(e)})},selectCommunity:function(e){var t=this,i={communityId:this.$store.getters.communityId};this.$xttp.get("/community/building/list",{params:i}).then(function(e){e.success&&(t.floorOptions=e.data)})},chargeType:function(){var e=this;this.$xttp.get("/fees/rule-types").then(function(t){t.success&&(e.chargeTypesOptions=t.data.ruleTypes,e.form.type=e.chargeTypesOptions[0].key)})},changeTypeOptions:function(e){3!=e.key&&(this.isShow=!0),3==e.key&&1==this.isShow&&(this.isShow=!1,this.form.unitPrice)},handleChange:function(e){var t=e.toFixed(2);this.form.unitPrice=1e4*t}}},n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.titleFont,visible:e.msg,"before-close":e.handleClose},on:{"update:visible":function(t){e.msg=t}}},[i("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{model:e.form,rules:e.rules}},[i("el-form-item",{staticClass:"c-must",attrs:{label:"项目名称：","label-width":e.formLabelWidth,prop:"itemName"}},[i("el-input",{model:{value:e.form.itemName,callback:function(t){e.$set(e.form,"itemName",t)},expression:"form.itemName"}})],1),e._v(" "),i("el-form-item",{staticClass:"c-must",attrs:{label:"计费规则：","label-width":e.formLabelWidth,prop:"type"}},[i("el-radio-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.chargeTypesOptions,function(t){return i("el-radio",{key:t.value,attrs:{label:t.key,value:t.value,border:""},on:{change:function(i){e.changeTypeOptions(t)}}},[e._v(e._s(t.value))])}))],1),e._v(" "),e.isShow?i("el-form-item",{staticClass:"c-must",attrs:{label:"计费单价：",prop:"unitPrice","label-width":e.formLabelWidth}},[i("el-input-number",{attrs:{step:.01,min:.01},model:{value:e.form.unitPrice,callback:function(t){e.$set(e.form,"unitPrice","string"==typeof t?t.trim():t)},expression:"form.unitPrice"}}),e._v("  (元)\n        ")],1):e._e(),e._v(" "),i("el-form-item",{staticClass:"c-must",attrs:{label:"适用楼栋：","label-width":e.formLabelWidth,prop:"floorSer"}},[i("el-select",{attrs:{disabled:"disabled",clearable:"",placeholder:"适用所有楼栋"},model:{value:e.form.floorSer,callback:function(t){e.$set(e.form,"floorSer",t)},expression:"form.floorSer"}},e._l(e.floorOptions,function(e){return i("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})}))],1),e._v(" "),i("el-form-item",{attrs:{"label-width":e.formLabelWidth}},[i("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.save("ruleForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var l=i("VU/8")(r,n,!1,function(e){i("L//a")},"data-v-08bda2b6",null).exports,c={name:"ChargeAdd",data:function(){return{formLabelWidth:"120px",titleFont:"周期管理",isShow:!1,params:[],form:{chargeStandard:"按月收费",payCycle:"30",billDate:"26"},rules:{itemName:[{required:!0,message:"请输入项目名称",trigger:"blur"}],type:[{required:!0,message:"请选择计费规则",trigger:"blur"}],unitPrice:[{required:!0,message:"请输入单价",trigger:"blur"}]},chargeStandardOptions:[{id:1,name:"按月收费"}],paySycleOptions:[{id:30,name:"30"},{id:45,name:"45"},{id:60,name:"60"},{id:90,name:"90"}]}},props:["msg","add","projectData"],created:function(){this.getInit()},mounted:function(){},methods:{handleClose:function(){this.$emit("upcycle",this.current)},getInit:function(){var e=this,t=this.$store.getters.communityId,i={};i.communityId=t,i.type=1,this.loading=!0,this.$xttp.post("/property/parameter/page",i).then(function(t){t.success&&(e.form.payCycle=t.data.records[0].value,e.form.payCycleId=t.data.records[0].id,e.form.billDateId=t.data.records[1].id,e.form.billDate=t.data.records[1].value)})},save:function(){var e=this,t=this.form.payCycle,i=this.form.payCycleId,a=this.form.billDateId,s=this.form.billDate,o=[];o.push(i),o.push(a);var r=[];r.push(t),r.push(s);var n=["id","value"];this.params=o.map(function(e,t){var i={};return i[n[0]]=o[t],i[n[1]]=r[t],i});this.$xttp.post("/property/parameter/multi-edit",this.params).then(function(t){t.success?(e.$message({message:"收费周期参数配置成功",type:"success"}),e.current=2,e.handleClose(),e.$emit("reload")):e.$message({message:t.data.errorMsg,type:"error"})}).catch(function(e){console.log(e)})},selectCommunity:function(e){var t=this,i={communityId:this.$store.getters.communityId};this.$xttp.get("/community/building/list",{params:i}).then(function(e){e.success&&(t.floorOptions=e.data,t.form.floorSer=t.floorOptions[0].id)})},chargeType:function(){var e=this;this.$xttp.get("/fees/rule-types").then(function(t){t.success&&(e.chargeTypesOptions=t.data.ruleTypes)})},changeTypeOptions:function(e){3!=e.key&&(this.isShow=!0),3==e.key&&1==this.isShow&&(this.isShow=!1,this.form.unitPrice)},handleChange:function(e){var t=e.toFixed(2);this.form.unitPrice=1e4*t}}},u={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.titleFont,visible:e.msg,"before-close":e.handleClose},on:{"update:visible":function(t){e.msg=t}}},[i("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{model:e.form,rules:e.rules}},[i("el-form-item",{staticClass:"c-must",attrs:{label:"收费标准：","label-width":e.formLabelWidth,prop:"chargeStandard"}},[i("el-select",{model:{value:e.form.chargeStandard,callback:function(t){e.$set(e.form,"chargeStandard",t)},expression:"form.chargeStandard"}},e._l(e.chargeStandardOptions,function(e){return i("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})}))],1),e._v(" "),i("el-form-item",{staticClass:"c-must",attrs:{label:"缴费周期(天)：","label-width":e.formLabelWidth,prop:"payCycle"}},[i("el-select",{attrs:{clearable:"",placeholder:"选择缴费周期"},model:{value:e.form.payCycle,callback:function(t){e.$set(e.form,"payCycle",t)},expression:"form.payCycle"}},e._l(e.paySycleOptions,function(e){return i("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})}))],1),e._v(" "),i("el-form-item",{staticClass:"c-must",attrs:{label:"账单生成日：","label-width":e.formLabelWidth,prop:"billDate"}},[i("el-col",{attrs:{span:10}},[i("el-input",{attrs:{type:"number",step:"1",max:"28",min:"1",placeholder:"请选择账单生成日"},model:{value:e.form.billDate,callback:function(t){e.$set(e.form,"billDate",t)},expression:"form.billDate"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{"label-width":e.formLabelWidth}},[i("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.save("ruleForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var m=i("VU/8")(c,u,!1,function(e){i("4QGD")},"data-v-21930434",null).exports,d=i("NYxO"),f=(i("2hfY"),{name:"class",data:function(){return{loading:!1,show:!1,isShow:!1,isSee:!1,isCycle:!1,seeData:null,visible2:!1,delData:null,cycleData:null,formDetail:{},navDetailData:[{id:0,name:"物业管理"},{id:1,name:"收费管理"},{id:2,name:"收费管理"}],tableData:[],pageSize:10,total:0,msg:"",currentPage:1,projectData:null}},computed:Object(d.b)(["showAside"]),components:{SeePage:o,AddPage:l,CyclePage:m},methods:{query:function(){1!==this.currentPage?this.currentPage=1:this.getTableList()},getTableList:function(){var e=this;this.loading=!0;var t=this.$store.getters.communityId,i=localStorage.getItem("propertyId"),a="/fees/item/page?page="+this.currentPage+"&size="+this.pageSize;this.$xttp.get(a,{params:{communityId:t,propertyId:i}}).then(function(t){e.loading=!1,t.success&&(e.tableData=t.data.records,e.total=t.data.total)}).catch(function(){e.loading=!1})},addProject:function(){this.projectData=null,this.isShow=!this.isShow},cycleMang:function(){this.cycleData=null,this.isCycle=!this.isCycle},upcycle:function(e){this.isCycle=!1},change:function(e){1==e?this.isShow=!1:2!=e&&3!=e||(this.isShow=!1)},upsee:function(e){this.isSee=!1},delHandle:function(e){this.visible2=!0,this.delData=e},seeHandle:function(e){this.isSee=!0,this.formDetail=e},confirmDel:function(){var e=this;this.delData.id&&this.$xttp.get("fees/item/delete/"+this.delData.id).then(function(t){e.loading=!1,t.success?(e.visible2=!1,e.delData=null,e.$message({message:"删除成功！",type:"success"}),e.query()):(e.visible2=!1,e.delData=null,e.query())}).catch(function(){e.loading=!1})},editHandle:function(e){var t=this,i="/fees/item/edit/"+e.id;this.$prompt("请输入收费项目名称","修改收费项目",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(e){var a=e.value;t.$xttp.post(i,{itemName:a}).then(function(e){e.success&&t.getTableList()})}).catch(function(){t.$message({type:"info",message:"修改收费项目失败"})})}},created:function(){this.query()}}),p={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",[i("el-main",[i("div",[i("ul",{staticClass:"c-navDetail clear"},e._l(e.navDetailData,function(t,a){return i("li",{key:a},[e._v(e._s(t.name)+" "),a!==e.navDetailData.length-1?i("span",[e._v(" > ")]):e._e()])})),e._v(" "),i("div",{staticClass:"c-notice-container"},[i("div",{staticClass:"c-searchbar"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[i("el-form-item",{staticStyle:{float:"right","margin-bottom":"4px"}},[i("el-button",{attrs:{type:"primary plain"},on:{click:e.cycleMang}},[e._v("周期管理")])],1),e._v(" "),i("el-form-item",{staticStyle:{float:"right","margin-bottom":"4px"}},[i("el-button",{attrs:{type:"success plain"},on:{click:e.addProject}},[e._v("新增项目")])],1)],1)],1)])]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"c-table",staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData,stripe:""}},[i("el-table-column",{attrs:{label:"序号",width:"120",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s((e.currentPage-1)*e.pageSize+t.$index+1))]}}])}),e._v(" "),e.show?i("el-table-column",{attrs:{label:"ID","min-width":"80",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.id))]}}])}):e._e(),e._v(" "),e.show?i("el-table-column",{attrs:{label:"创建时间","min-width":"160",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("time")(t.row.createAt,"yyyy-MM-dd HH:mm:ss")))]}}])}):e._e(),e._v(" "),i("el-table-column",{attrs:{label:"收费项目","min-width":"200",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.itemName))]}}])}),e._v(" "),i("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.seeHandle(t.row)}}},[e._v("查看")]),e._v(" "),i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(i){e.editHandle(t.row)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(i){e.delHandle(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("div",{staticClass:"c-pagination"},[i("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage},on:{"current-change":e.getTableList,"update:currentPage":function(t){e.currentPage=t}}})],1),e._v(" "),i("transition",{attrs:{name:"add"}},[e.isShow?i("AddPage",{attrs:{msg:e.isShow,add:e.projectData},on:{reload:e.query,upup:e.change,"update:add":function(t){e.projectData=t}}}):e._e()],1),e._v(" "),i("transition",{attrs:{name:"see"}},[e.isSee?i("SeePage",{attrs:{detail:e.formDetail,msg:e.isSee},on:{reload:e.query,upsee:e.upsee}}):e._e()],1),e._v(" "),i("transition",{attrs:{name:"cycle"}},[e.isCycle?i("CyclePage",{attrs:{msg:e.isCycle,data:e.cycleData},on:{reload:e.query,upcycle:e.upcycle}}):e._e()],1),e._v(" "),i("el-dialog",{attrs:{title:"温馨提示",visible:e.visible2},on:{"update:visible":function(t){e.visible2=t}}},[i("p",[e._v("请问您确定要删除这条数据吗？")]),e._v(" "),i("div",{staticStyle:{"text-align":"right",marigin:"0"}},[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visible2=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmDel}},[e._v("确定")])],1)])],1)],1)},staticRenderFns:[]};var h=i("VU/8")(f,p,!1,function(e){i("cSdB")},"data-v-438a9365",null);t.default=h.exports},"L//a":function(e,t){},cSdB:function(e,t){}});
//# sourceMappingURL=9.2f3f409a43b36b19ec27.js.map